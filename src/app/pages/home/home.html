<header class="bg-gray-800 text-white p-2">
  <h1 class="text-2xl font-700 text-center">Расписание на месяц</h1>
</header>

<main class="p-2 dark:text-white">
  <div class="flex justify-center items-center">
    <button (click)="onPreviousMonthClick()" class="text-xl font-500 text-center mb-4 px-4 capitalize order-first">←</button>
    <button (click)="onNextMonthClick()" class="text-xl font-500 text-center mb-4 px-4 capitalize order-last">→</button>
    <h2 class="text-xl font-500 text-center mb-4 capitalize order-2 w-[8em]">{{ selectedDate().toLocaleDateString("ru-RU", {
      month: "long",
      year: "numeric",
    }) }}</h2>
  </div>

  <div class="max-w-full overflow-x-auto mb-15">
    @if (schedule.specialists$ | async; as data) {
      @if (data | isNotEmpty : year().toString() : month().toString()) {
        <table class="border-y font-500 specialists-table mx-auto" cellpadding="0" cellspacing="0">
          <thead>
            <tr>
              <th class="px-5 py-1 border-x border-b sticky left-[0] backdrop-blur-xl">Специалист</th>
                @for (day of monthDates(); track day.date) {
                  @if (day.isToday) {
                    <th class="px-2 py-1 border-b border-r bg-red-500" #todayCol>
                      <span class="text-white">●&nbsp;{{day.date}}</span>
                    </th>
                  } @else {
                    <th class="px-2 py-1 border-b border-r" [class]="{
                      'bg-gray-400': day.isWeekend,
                      'dark:bg-gray-500': day.isWeekend,
                    }">{{day.date}}</th>
                  }
                }
            </tr>
          </thead>
          <tbody>
            @for (specialist of data; track specialist.id) {
              @if (specialist.dates[year().toString()] !== undefined && specialist.dates[year().toString()]![month().toString()] !== undefined) {
                <tr>
                  <td
                    class="sticky left-[0] backdrop-blur-xl text-nowrap px-2 py-2 pr-4 align-middle border-x border-b z-10"
                    [style.backgroundColor]="SpecialistColor.get(specialist.role)"
                  >
                    <div class="font-500">{{specialist.name}}</div>
                    <div class="text-xs">
                      <strong class="font-700">{{specialist.role | rolename}}</strong>,
                      смен:&nbsp;<strong>{{specialist.dates[year().toString()]![month().toString()]! | numberofdays }}</strong>
                    </div>
                  </td>
                  @for (specialistIsAvailable of specialist.dates[year().toString()]![month().toString()]!; track $index) {
                  <td
                    class="text-center px-4 py-2 align-middle border-r"
                    [style.backgroundColor]="monthDates()[$index].isWeekend || monthDates()[$index].isToday ? '' : SpecialistColor.get(specialist.role)"
                    [class]="{
                      'bg-gray-400': monthDates()[$index].isWeekend,
                      'dark:bg-gray-500': monthDates()[$index].isWeekend,
                      'bg-red-500': monthDates()[$index].isToday,
                      'dark:bg-red-500': monthDates()[$index].isToday,
                    }"
                  >
                    <input
                      type="checkbox"
                      [checked]="specialistIsAvailable"
                      readonly
                      [name]="specialist.id"
                      [value]="$index + 1" class="size-7.5"
                      onclick="return false"
                    />
                  </td>
                  }
                </tr>
              }
            }
          </tbody>
        </table>
      } @else {
        <div class="text-center text-gray-500 py-5">Нет данных</div>
      }
    } @else {
      <div class="text-center text-gray-500 py-5">Загрузка&hellip;</div>
    }
</div>

  <div class="fixed bottom-0 left-0 right-0 px-3 py-3.5 z-10">
    <button
      (click)="onTodayClick()"
      class="border rounded-3xl text-center font-700 bg-gray-100 dark:bg-gray-900 px-5 py-2"
    >Сегодня</button>
  </div>
</main>
